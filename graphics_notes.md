## Overview

渲染分块进行，分块顺序控制和逐块取贴图、抖动、存帧缓冲为共用代码，已实现。

## 2D图形

#### 接口设计

2D绘制指令：贴图区域x,y,w,h，屏幕坐标xs,ys，深度h

#### 结构设计

上游为几何实例化模块。颜色RGB888 [0,224]

按块：取指令 - 筛选指令 - 深度测试 - 存贴图坐标和深度

块缓冲：80x80x(20+16) bits

## 3D图形

贴图预计算光照，使用扫描线+中点算法作透视插值。

#### 接口设计

第一步：逐顶点XYZUV, 相机位置

第二步：逐三角形变换后：包围盒，重心变换系数，顶点ZWUV

#### 结构设计

顶点着色器 - 透视除法 - 包围盒计算 - 重心变换系数预计算 - 按块：(放置背景 - 筛选三角形 - 栅格化)

其中栅格化步骤：计算重心坐标 - 边界测试 - 计算z,w - 计算透视坐标 - 深度测试 - 计算uv - 存贴图坐标和深度

#### 总结

三角形最少的建模（200个）：

铁轨 1 quad x 30

车厢 3 quad x 6 x 3

金币 1 quad x 30

#### 参考

Barenbrug, B & Peters, F. & Overveld, C.. (2000). Algorithms for division free perspective correct rendering. 10.1145/346876.346878. 

