## Overview

渲染分块进行，分块顺序控制和逐块取贴图、抖动、存帧缓冲为共用代码，已实现。

## 2D图形

#### 接口设计

2D绘制指令：贴图区域x,y,w,h，屏幕坐标xs,ys，深度h

#### 结构设计

上游为几何实例化模块。颜色RGB888 [0,224]

按块：取指令 - 筛选指令 - 深度测试 - 存贴图坐标和深度

块缓冲：80x80x(20+16) bits

## 3D图形

贴图预计算光照，使用扫描线+中点算法作透视插值。

#### 接口设计

2D绘制指令：三角形顶点世界坐标、贴图坐标；相机矩阵

#### 结构设计

上游为几何实例化模块，预先做大部分可见性剔除。

因贴图难以缓存，使用推迟着色。使用FIFO作模块间缓冲。

几何变换 - 筛选器 - 按块：(放置背景 - 逐三角形栅格化) -

其中栅格化步骤：维护扫描线边界 - 水平扫描 - 中点法插值 - 深度测试 - 存贴图坐标和深度

#### 总结

三角形最少的建模（200个）：

铁轨 1 quad x 30

车厢 3 quad x 6 x 3

金币 1 quad x 30

#### 参考

Barenbrug, B & Peters, F. & Overveld, C.. (2000). Algorithms for division free perspective correct rendering. 10.1145/346876.346878. 

